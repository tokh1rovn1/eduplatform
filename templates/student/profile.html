{% extends 'base.html' %}

{% block title %}Profilim{% endblock %}

{% block content %}
<div class="container mt-5">

    <!-- Foydalanuvchi sarlavhasi -->
    <div class="d-flex align-items-center mb-5">
        <div class="avatar rounded-circle bg-primary text-white d-flex justify-content-center align-items-center me-3" style="width:60px; height:60px; font-size:1.5rem;">
            <i class="bi bi-person-fill"></i>
        </div>
        <div>
            <h1 class="fw-bold mb-1">Salom, {{ user.username }}!</h1>
            <p class="text-muted mb-0">Sizning rolingiz: <strong>{{ user.get_role_display }}</strong></p>
        </div>
    </div>

    <!-- Yozilgan kurslar -->
    <h2 class="fw-semibold mb-3"><i class="bi bi-journal-bookmark-fill me-2 text-primary"></i> Yozilgan kurslarim</h2>

    <div class="row g-4">
        {% for enrollment in enrolled_courses %}
        <div class="col-md-6 col-lg-4">
            <a href="{% url 'course_detail' enrollment.course.id %}" class="card h-100 shadow-sm hover-card text-decoration-none text-dark">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <h5 class="card-title fw-bold">{{ enrollment.course.title }}</h5>
                        <small class="text-muted">O'qituvchi: {{ enrollment.teacher_name }}</small>
                    </div>
                    <p class="card-text mb-0">Ko'rilgan videolar: <span class="fw-semibold">{{ enrollment.viewed_count }}</span> / {{ enrollment.total_videos }}</p>
                    <div class="progress mt-3" style="height:8px;">
                        {% with percent=enrollment.viewed_count|div:enrollment.total_videos|mul:100 %}
                        <div class="progress-bar bg-primary" role="progressbar" style="width: {{ percent|default:0 }}%;" aria-valuenow="{{ percent|default:0 }}" aria-valuemin="0" aria-valuemax="100"></div>
                        {% endwith %}
                    </div>
                </div>
            </a>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="alert alert-info d-flex align-items-center">
                <i class="bi bi-info-circle me-2"></i> Siz hali hech qanday kursga yozilmagansiz.
            </div>
        </div>
        {% endfor %}
    </div>

</div>

<style>
/* Card hover effektlari */
.hover-card {
    border-radius: 12px;
    transition: transform 0.3s, box-shadow 0.3s;
}

.hover-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 25px rgba(0,0,0,0.08);
}

/* Avatar styling */
.avatar {
    font-size: 1.5rem;
}

/* Progress bar rounded */
.progress {
    border-radius: 8px;
}

.progress-bar {
    border-radius: 8px;
    transition: width 0.5s ease;
}
</style>
{% endblock %}
